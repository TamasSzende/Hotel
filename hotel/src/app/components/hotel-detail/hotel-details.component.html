<div class = container>

  <br>

  <div class="card mb-3">
    <div class="row no-gutters">


      <div class="col-md-4">
        <div>
          <mdb-carousel [isControls]="true" class="carousel slide carousel-fade" [animation]="'fade'">
            <mdb-carousel-item *ngFor="let imgURL of hotel?.hotelImageUrl">
              <div class="view w-100">
                <cl-image [public-id]="getPublicId(imgURL)">
                  <cl-transformation
                    height="600"
                    width="400"
                    crop="fill">
                  </cl-transformation>
                  <img class="d-block w-100" [src]="imgURL" alt="Hotel image">
                </cl-image>
                <div class="mask rgba-black-light waves-light" mdbWavesEffect></div>
              </div>
            </mdb-carousel-item>
          </mdb-carousel>
        </div>
      </div>

      <div class="col-md-8">
        <div class="card-body">
          <h3 class="card-title">{{hotel?.name}} - {{hotel?.hotelType}}</h3>
          <h5 class="card-subtitle mb-2">
            Address: {{hotel?.postalCode}}  {{hotel?.city}}, {{hotel?.streetAddress}}
          </h5>
          <p class="card-text">
            Hotel capacity: {{hotel?.hotelCapacity}}
          </p>
          <p class="card-text">
            {{ hotel?.description}}
          </p>
          <ul class="card-text">
            <li *ngFor="let hotelFeature of hotel?.hotelFeatures" class="text-muted">
              {{ hotelFeature }}
            </li>
          </ul>
          <div class="btn-toolbar" class="text-right" role="toolbar">
            <div class="btn-group mr-4">
              <button (click)="updateHotel()" *ngIf="userRole === 'ROLE_HOTELOWNER' || userRole === 'ROLE_ADMIN' "
                      class="btn btn-success ">edit Hotel data
              </button>
            </div>
            <div class="btn-group mr-4">
              <button (click)="backToHotelList()" *ngIf="userRole === 'ROLE_USER' || userRole === 'ROLE_ADMIN' "
                      class="btn btn-primary ">back to Hotel list
              </button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>


  <form [formGroup]="bookingForm">
    <div class="card bg-light mb-3">
      <div class="card-body">
        <div class="form-inline">
          <label for="numberOfGuests" lass="form-control-label">
            Vendégek száma:&nbsp;&nbsp;
          </label>
          <input
            formControlName="numberOfGuests"
            id="numberOfGuests"
            name="numberOfGuests"
            type="number"
          />
          &nbsp;&nbsp;
          <label>
            Utazás időpontja:&nbsp;&nbsp;
          </label>
          <ng2-flatpickr
            (change)="getFilteredRoomList()"
            [config]="flatpickrOptions"
            formControlName="bookingDateRange"
            id="bookingDateRange"
            name="bookingDateRange"
            placeholder="Válasz időpontot!"
          >
            <a class="input-button" data-clear title="clear">
              <i class="icon-close"></i>
            </a>
          </ng2-flatpickr>
          &nbsp;&nbsp;
          <div class="btn-group mr-4">
            <button (click)="resetFilters()" class="btn btn-secondary">Reset</button>
          </div>

          <button (click)="makeBooking()" class="btn btn-warning mr-4">Foglalás</button>

          &nbsp;&nbsp;
          <h5 *ngIf="priceOfBooking"> Ár: {{ priceOfBooking.toLocaleString('hu-HU') }} Ft </h5>

        </div>

        <form [formGroup]="filterForm">
          <div class="form-group">
            <div *ngFor="let roomFeatures of roomFeatureTypeOption; let i = index" class="form-check form-check-inline"
                 formArrayName="roomFeatures">
              <input (change)="getFilteredRoomList()" [formControlName]="i" class="form-check-input" type="checkbox">
              <label class="form-check-label">
                {{ roomFeatures?.displayName }}
              </label>
            </div>
          </div>
        </form>

      </div>
    </div>

    <h4 *ngIf="hotel?.rooms.length !==0">
      Szabad szobák:
    </h4>
    <h5 *ngIf="hotel?.rooms.length === 0">
      Sajnos a megadott időszakban nincs a keresésnek megfelelő szabad szobánk!
    </h5>


    <div *ngFor="let room of hotel?.rooms; let i = index" formArrayName="roomIdList">
      <div class="card mb-3">
        <div class="row no-gutters">
          <div class="col-md-4">
            <img *ngIf="room.roomImageUrl" [src]="room.roomImageUrl" alt="roomImage" class="card-img">
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <h5 class="card-title">{{ room.roomName }} - {{ room.roomType }}</h5>
              <h6 class="card-subtitle mb-2">
                Number of beds: {{ room.numberOfBeds }} - Room area: {{ room.roomArea }} m2 - Price per Night
                : {{ room.pricePerNight.toLocaleString('hu-HU') }} Ft
              </h6>

              <p class="card-text">
                {{ room.description}}
              </p>

              <p class="card-text">
                <small *ngFor="let roomFeature of room.roomFeatures" class="text-muted">
                  &#9679;{{ roomFeature }} &shy;
                </small>
              </p>
              <div class="btn-toolbar" class="text-right" role="toolbar">

                <div *ngIf="userRole === 'ROLE_HOTELOWNER' || userRole === 'ROLE_ADMIN' " class="btn-group mr-4">
                  <button (click)="roomDetail(room.id)" class="btn btn-primary btn-sm">details</button>
                </div>
                <div class="btn-group mr-4">
                  <button (click)="updateRoom(room.id)" class="btn btn-secondary btn-sm">&nbsp;&nbsp;edit&nbsp;&nbsp;
                  </button>
                  <button (click)="deleteRoom(room.id)" class="btn btn-danger btn-sm">delete</button>
                </div>

                <label>
                  Lefoglalom&nbsp;
                  <input (change)="getPriceOfBooking()" [formControlName]="i" style="width: 18px; height: 18px"
                         type="checkbox">
                </label>
              </div>

            </div>

          </div>
        </div>
      </div>


    </div>
  </form>

  <button (click)="createRoomInHotel()" *ngIf="userRole === 'ROLE_HOTELOWNER'" class="btn btn-primary btn-lg btn-block"
          type="button">Add new room
  </button>

  <br>
  <br>
  <br>

</div>



